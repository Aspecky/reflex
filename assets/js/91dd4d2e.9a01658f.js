"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[612],{6286:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var r=a(1966),n=(a(9496),a(9613));const l={description:"API Reference for Reflex, a state management library for Roblox."},i="Reflex",s={unversionedId:"reference/reflex/reflex",id:"reference/reflex/reflex",title:"Reflex",description:"API Reference for Reflex, a state management library for Roblox.",source:"@site/docs/reference/reflex/reflex.md",sourceDirName:"reference/reflex",slug:"/reference/reflex/",permalink:"/reflex/docs/reference/reflex/",draft:!1,tags:[],version:"current",frontMatter:{description:"API Reference for Reflex, a state management library for Roblox."},sidebar:"referenceSidebar",next:{title:"createProducer",permalink:"/reflex/docs/reference/reflex/create-producer"}},o={},c=[{value:"Producers",id:"producers",level:2},{value:"Selectors",id:"selectors",level:2},{value:"Middleware",id:"middleware",level:2},{value:"Server-to-client sync",id:"server-to-client-sync",level:2}],p={toc:c},d="wrapper";function u(e){let{components:t,...a}=e;return(0,n.kt)(d,(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"reflex"},"Reflex"),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Reflex")," allow you to efficiently track and manage the state of your game. This page documents the core Reflex APIs."),(0,n.kt)("p",null,"Reflex provides these top-level exports:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-producer"},(0,n.kt)("inlineCode",{parentName:"a"},"createProducer(initialState, actions)"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"combine-producers"},(0,n.kt)("inlineCode",{parentName:"a"},"combineProducers(producers)"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-selector"},(0,n.kt)("inlineCode",{parentName:"a"},"createSelector(dependencies, combiner)"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-broadcaster"},(0,n.kt)("inlineCode",{parentName:"a"},"createBroadcaster(options)"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-broadcast-receiver"},(0,n.kt)("inlineCode",{parentName:"a"},"createBroadcastReceiver(options)"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"middleware#loggermiddleware"},(0,n.kt)("inlineCode",{parentName:"a"},"loggerMiddleware")))),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"producers"},"Producers"),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Producers")," are the state containers that control the state of your game. They are the core of Reflex and are used to listen to state changes and dispatch actions."),(0,n.kt)("p",null,"Explore how to use producers to manage your game:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-producer"},(0,n.kt)("inlineCode",{parentName:"a"},"createProducer"))," creates a producer with an initial state and a set of actions.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-producer#updating-state-with-actions"},"Updating state with actions")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-producer#updating-nested-state"},"Updating nested state")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-producer#importing-and-exporting-types"},"Importing and exporting types")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"producer"},"Producers")," contain your state, actions, and everything you need to manage them.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"producer#running-side-effects"},"Running side effects")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"producer#waiting-for-state-changes"},"Waiting for state changes")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"producer#transforming-state-with-selectors"},"Transforming state with selectors")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"producer#using-the-observer-pattern"},"Using the observer pattern")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"combine-producers"},(0,n.kt)("inlineCode",{parentName:"a"},"combineProducers"))," lets you compose a new producer of multiple slices.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"combine-producers#using-multiple-producers"},"Using multiple producers")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"combine-producers#selecting-combined-state"},"Selecting combined state")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"combine-producers#dispatching-one-action-to-multiple-producers"},"Dispatching one action to multiple producers"))))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"const producer = createProducer(0, {\n    increment: (state, value: number) => state + value,\n    decrement: (state, value: number) => state - value,\n    set: (_, value: number) => value,\n});\n")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"selectors"},"Selectors"),(0,n.kt)("p",null,"If your state is a complex object, you can use ",(0,n.kt)("em",{parentName:"p"},"selectors")," to extract specific parts of it. Selectors are functions that take your state and return a subset of it. Reflex offers a built-in function to write efficient selectors:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-selector"},(0,n.kt)("inlineCode",{parentName:"a"},"createSelector"))," optimizes selectors to only run when state changes.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-selector#transforming-state"},"Transforming state")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-selector#passing-input-parameters"},"Passing input parameters"))))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"const selectItems = (state: State) => state.items;\n\nconst selectInStock = createSelector([selectItems], (items) => {\n    return items.filter((item) => item.stock > 0);\n});\n")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"middleware"},"Middleware"),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Middleware")," lets you enhance actions and producers with additional functionality. You can use middleware to add logging, patch methods, cancel actions, and more."),(0,n.kt)("p",null,"Reflex provides some commonly used middleware:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"middleware#loggermiddleware"},(0,n.kt)("inlineCode",{parentName:"a"},"loggerMiddleware"))," logs all actions and state changes.")),(0,n.kt)("p",null,"You can also ",(0,n.kt)("a",{parentName:"p",href:"middleware#your-first-middleware"},"define your own middleware"),":"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"middleware#your-first-middleware"},"Your first middleware")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"middleware#cancelling-actions"},"Cancelling actions"))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts"},"producer.applyMiddleware(loggerMiddleware, customMiddleware);\n")),(0,n.kt)("hr",null),(0,n.kt)("h2",{id:"server-to-client-sync"},"Server-to-client sync"),(0,n.kt)("p",null,"Reflex offers a built-in solution to sync state between the server and the client with ",(0,n.kt)("em",{parentName:"p"},"broadcasters")," and ",(0,n.kt)("em",{parentName:"p"},"receivers"),". They assist the server with separating private and shared state, and they help the client with syncing state with the server."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-broadcaster"},(0,n.kt)("inlineCode",{parentName:"a"},"createBroadcaster"))," creates a broadcaster that shares server state with clients."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-broadcast-receiver"},(0,n.kt)("inlineCode",{parentName:"a"},"createBroadcastReceiver"))," creates a receiver that syncs client state with the server.")),(0,n.kt)("p",null,"Explore how to use broadcasters and receivers to sync state:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-broadcaster#sending-server-state-to-clients"},"Sending server state to clients")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"create-broadcast-receiver#syncing-server-state-on-the-client"},"Syncing server state on the client"))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Server snippet"',title:'"Server','snippet"':!0},'const broadcaster = createBroadcaster({\n    producers: sharedProducers,\n    broadcast: (players, actions) => {\n        remotes.Server.Get("broadcast").SendToPlayers(players, actions);\n    },\n});\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="Client snippet"',title:'"Client','snippet"':!0},'const receiver = createBroadcastReceiver({\n    requestState: async () => {\n        const remote = await remotes.Client.WaitFor("requestState");\n        return remote.CallServerAsync();\n    },\n});\n')))}u.isMDXComponent=!0}}]);